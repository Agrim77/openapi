<%- include('./partials/header') %>
<script>
let isThanksPage = true;
</script>
<script defer src="/js/search_qs.js"></script>
<script src="/js/q_and_a_drop.js"></script>
<script src="/js/dropdown_qs.js"></script>
<script src="/js/animate.js"></script>
<script src="/js/email.js"></script>
<title>Ready !</title>
  </head>
<body>
<%- include('./partials/navbar') %>
<div class="page3">
  <!-- <div class="pdf_sec1">
    <h1>Success</h1>
  </div> -->
  

  <!-- <div class="pdf_sec2">
    <div class="dash_section4_head">
        <h1 style="font-weight:700;">Your Curated Top Interview Questions</h1>
        <p style="color:grey;">Everything you need to know to ace your interviews!</p>
    </div>
  </div> -->
  <div class="dash_section2" style="margin-top: 7%;">
    <div class="user_dash">
      <div class="user_content">
        <h1>Good Evening User !</h1>
        <br />
        <p>A simple quote of the day !</p>
      </div>
      <div class="user_img">
        <img src="images/vector.png" alt="" />
      </div>
    </div>
    <div class="user_nav">
      <div>
        <h2><%- result.length %> Questions</h2>
      </div>
      <div class="dropdown-container">
        <div class="btn-group dropstart">
          <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            Select Your Question
          </button>
          <ul class="dropdown-menu dropdown-menu-lg-start">
            <% for (let i = 0; i < result.length; i++) { %>
              <li>
                <a class="dropdown-item" href="#question<%= i %>"><%= i+1 %>: <%= result[i].ques.substring(0, 27) %> ....</a>
                <!-- <li><a class="dropdown-item disabled">Disabled link</a></li> -->
              </li>
              <% } %>
          </ul>
        </div>
      </div>
      
      
    </div>
  </div>

  <div class="dash_section3">
    <h4 style="font-weight:700;">Hi User,</h4>
    <h1 style="font-weight:700;">We are here to help</h1>
    <p style="color:grey;">
      Welcome to the expert response to the 50 top
      interview questions tailored to you !
    </p>
  </div>
    
    <!----Q/A's---->
  <div class="pdf_sec4">
      <div class="pdf_dash_section4">

      <!---- SEARCH & DROPDOWN OF QUESTIONS----->
      <div class="pdf_tools">
        <!------SEARCH------->
        <div class="dashboard_search">
          <div class="search-bar">
            <input
              type="text"
              id="search-input"
              placeholder="What are you looking for?"
            />
            <button id="search-button">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
  
        <!------DROPDWON TO SELECT QUESTIONS----->
        <div class="dropdown-container">
            <div class="btn-group dropstart">
              <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                Select Your Question
              </button>
              <ul class="dropdown-menu dropdown-menu-lg-start">
                <% for (let i = 0; i < result.length; i++) { %>
                  <li>
                    <a class="dropdown-item" href="#question<%= i %>"><%= i+1 %>: <%= result[i].ques.substring(0, 27) %> ....</a>
                  </li>
                  <% } %>
              </ul>
            </div>
        </div>
  
      </div>
      
        <% for (let i = 0; i < result.length; i++) { %>
          <div class="qs " id="question<%=i%>">
              <div class="question">
                <div class="question_area"><h4><pre><%- i+1 %>: <%= unescape(result[i].ques) %></pre></h4></div>
                <div class="question_click">
                  <i class="fa-solid fa-circle-plus" style="color: #5794ff;" onclick="toggleAnswer(`<%- i %>`);"></i>
                </div>
              </div>  
              <pre id="answer<%=i%>" class="answer_text " style="display: none;"><%- result[i].ans %></pre>
          </div>
          <% } %>

          <br>
          <!-- <div class="pagination">
            <nav aria-label="Page navigation example">
              <ul class="pagination">
                <li class="page-item"><a class="page-link" href="/thanks?page=1">15 Questions</a></li>
                <li class="page-item"><a class="page-link" href="/thanks?page=2">15 Questions</a></li>
                <li class="page-item"><a class="page-link" href="/thanks?page=3">20 Questions</a></li>
              </ul>
            </nav>
          </div> -->
          
      </div>
  </div>
    


    <div class="pdf_display">
      <div class="pdf_email">

        <h2> Generate Your Curated Answers PDF !</h2>
      <br>
      <!-- <div class="buttons pdf_gen_button">
        <button id="pdf_gen_button" class="btn-p">Generate pdf</button>
      </div> -->
      <!-- <div id="pdf_frame_container"> -->
        <iframe id="pdf_frame" src="/pdfs/q_and_a.pdf" width="100%" height="600px"></iframe>
      <!-- </div> -->
      <br><br>
      <a href="/pdfs/q_and_a.pdf" download class="download-button">Download PDF</a>
        <form id="pdf_form" method="post" action="/send-email">
          <div class="card-container">
            <div
              class="card text-center p-4 shadow"
              style="width: 25rem; border-radius: 29px; box-shadow: 0 25px 25px rgba(0, 0, 0, 0.1), 0 25px 25px rgba(0, 0, 0, 0.1);"
            >
              <h2 class="card-title pb-3">Write Your Details</h2>
    
              <div class="mb-3">
                <label for="user_email" class="form-label">Your Email:</label>
                <input type="email" class="form-control" name="user_email" aria-describedby="emailHelp" required>
              </div>
    
              <div class="mb-3">
                <label for="user_name" class="form-label"> Your Name:</label>
                <input type="text" class="form-control" name="user_name" aria-describedby="emailHelp" required>
              </div>
    
              <div class="mb-3">
                <label for="user_country" class="form-label">Your Country:</label>
                <select name="user_country" id="user_country" class="form-control" required>
                  <% countries.forEach(country => { %>
                    <option id="" data-country-code="<%= country.isoCode %>" value="<%= country.name %>"><%= country.name %></option>
                  <% }); %>
                </select>
              </div>
        
              <div class="mb-3">
                <label name="user_city" for="user_city" class="form-label">Your City:</label>
                <select id="city-select" class="form-control" required>
                  <option value="">Select City</option>
                </select>
              </div>
              
              <div class="buttons pdf_email_button">
                <button id="email-button" type="submit" class="btn-p">Email Me PDF</button>
              </div>
          </div>
          
         
        </div>
        </form>
      </div>
      <br>
      
    </div>

    

    
      
</div>

<script>
  const countrySelect = document.getElementById('user_country');
  const citySelect = document.getElementById('city-select');
    countrySelect.addEventListener('change', async () => {
      const selectedOption = countrySelect.options[countrySelect.selectedIndex];
      const countryCode = selectedOption.getAttribute('data-country-code');

      // Fetch the cities of the selected country using the country code
      const response = await fetch(`/cities/${countryCode}`);
      const cities = await response.json();

      // Clear existing options
      citySelect.innerHTML = '<option value="">Select City</option>';

      // Populate the cities dropdown with the retrieved cities
      cities.forEach(city => {
        const option = document.createElement('option');
        option.value = city;
        option.textContent = city;
        citySelect.appendChild(option);
      });
    });
  
    //------------pdf generation----------
  //   document.getElementById('pdf_gen_button').addEventListener('click', function() {
  //   fetch('/generate_pdf', {
  //     method: 'POST',
  //     headers: {
  //       'Content-Type': 'application/json'
  //     },
  //     // body: JSON.stringify({ /* Any data you want to send to the server */ })
  //   })
  //   .then(function(response) {
  //     if (response.ok) {
  //       return response.json();
  //     } else {
  //       throw new Error('Failed to generate PDF');
  //     }
  //   })
  //   .then(function(data) {
  //     const pdfPath = data.pdf_path;
  //     document.getElementById('pdf_frame').src = pdfPath;
  //     document.getElementById('pdf_frame').style.display = 'block';
  //   })
  //   .catch(function(error) {
  //     console.error('Error generating PDF:', error);
  //   });
  // });

  //Showing icons
  function toggleAnswer(index) {
  const answerElement = document.getElementById(`answer${index}`);
  const iconElement = document.querySelector(`#question${index} .question_click i`);
  if (answerElement.style.display === 'none') {
    answerElement.style.display = 'block';
    iconElement.classList.remove('fa-circle-plus');
    iconElement.classList.add('fa-circle-minus');

    
  } else {
    answerElement.style.display = 'none';
    iconElement.classList.remove('fa-circle-minus');
    iconElement.classList.add('fa-circle-plus');
  }
}
</script>
<%- include('./partials/footer') %>